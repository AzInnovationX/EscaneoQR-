<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asistente Inteligente Avanzado</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .chat-container {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            height: 100vh;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            display: flex;
            flex-direction: column;
            border-radius: 20px;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 25px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .header-content {
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
            z-index: 2;
        }

        .bot-avatar {
            position: relative;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ff6b6b, #ffd93d);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .status-indicator {
            position: absolute;
            bottom: -3px;
            right: -3px;
            width: 20px;
            height: 20px;
            background: #10b981;
            border: 4px solid white;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(16, 185, 129, 0); }
            100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }

        .header-text h1 {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 5px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .header-text p {
            font-size: 16px;
            opacity: 0.9;
            font-weight: 500;
        }

        .intelligence-indicator {
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .quick-actions {
            padding: 25px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-bottom: 2px solid #e2e8f0;
        }

        .quick-actions p {
            color: #475569;
            font-size: 16px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 18px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
            font-weight: 600;
            color: #334155;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .action-btn:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
            background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
        }

        .message {
            display: flex;
            margin-bottom: 25px;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-content {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            max-width: 75%;
        }

        .message.user .message-content {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .message-avatar.bot {
            background: linear-gradient(135deg, #ff6b6b, #ffd93d);
            color: white;
        }

        .message-avatar.user {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .message-bubble {
            padding: 20px 25px;
            border-radius: 25px;
            font-size: 16px;
            line-height: 1.6;
            position: relative;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
        }

        .message-bubble.bot {
            background: white;
            color: #374151;
            border-bottom-left-radius: 8px;
            border: 2px solid #e2e8f0;
        }

        .message-bubble.user {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-bottom-right-radius: 8px;
        }

        .message-time {
            font-size: 12px;
            margin-top: 10px;
            opacity: 0.7;
            font-weight: 500;
        }

        .thinking-process {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2px solid #f59e0b;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            font-size: 14px;
            color: #92400e;
            font-weight: 600;
        }

        .typing-indicator {
            display: flex;
            justify-content: flex-start;
            margin-bottom: 25px;
        }

        .typing-content {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            max-width: 75%;
        }

        .typing-bubble {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 25px;
            border-bottom-left-radius: 8px;
            padding: 20px 25px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
        }

        .typing-dots {
            display: flex;
            gap: 8px;
        }

        .typing-dot {
            width: 10px;
            height: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1.2); opacity: 1; }
        }

        .input-area {
            background: white;
            border-top: 2px solid #e2e8f0;
            padding: 25px;
            box-shadow: 0 -10px 30px rgba(0,0,0,0.1);
        }

        .input-container {
            display: flex;
            align-items: flex-end;
            gap: 20px;
        }

        .input-wrapper {
            flex: 1;
            position: relative;
        }

        #messageInput {
            width: 100%;
            padding: 18px 25px;
            border: 2px solid #e2e8f0;
            border-radius: 30px;
            font-size: 16px;
            font-family: inherit;
            resize: none;
            max-height: 150px;
            min-height: 55px;
            transition: all 0.3s ease;
            background: #f8fafc;
        }

        #messageInput:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            background: white;
        }

        .send-btn {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .send-btn:hover:not(:disabled) {
            transform: scale(1.1) translateY(-2px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .actions-grid {
                grid-template-columns: 1fr;
            }
            
            .message-content {
                max-width: 90%;
            }
            
            .action-btn {
                font-size: 14px;
                padding: 15px;
            }
            
            .chat-container {
                border-radius: 0;
            }

            .intelligence-indicator {
                display: none;
            }
        }

        /* Scrollbar personalizada */
        .messages-container::-webkit-scrollbar {
            width: 8px;
        }

        .messages-container::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .messages-container::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 4px;
        }

        .messages-container::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #5a67d8, #6b46c1);
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="bot-avatar">
                    üß†
                    <div class="status-indicator"></div>
                </div>
                <div class="header-text">
                    <h1>Asistente Inteligente</h1>
                    <p>Tu compa√±ero de IA para la innovaci√≥n y la productividad</p>
                </div>
                <div class="intelligence-indicator">
                    üöÄ IA Avanzada
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <p>üí° ¬øC√≥mo puedo ayudarte a empezar?</p>
            <div class="actions-grid">
                <button class="action-btn" onclick="setQuickMessage('Quiero una estrategia para hacer crecer mi negocio.')">
                    üöÄ Dame una estrategia de negocio
                </button>
                <button class="action-btn" onclick="setQuickMessage('Necesito un plan de marketing digital innovador.')">
                    üìà Crea un plan de marketing
                </button>
                <button class="action-btn" onclick="setQuickMessage('Ay√∫dame a optimizar mis procesos de trabajo.')">
                    ‚ö° Optimiza mis procesos
                </button>
                <button class="action-btn" onclick="setQuickMessage('Hagamos una sesi√≥n de brainstorming para una nueva idea.')">
                    üß† Hagamos brainstorming
                </button>
            </div>
        </div>

        <!-- Messages -->
        <div class="messages-container" id="messagesContainer">
            <div class="message bot">
                <div class="message-content">
                    <div class="message-avatar bot">üß†</div>
                    <div class="message-bubble bot">
                        <div>
                            ¬°Hola! Soy tu asistente inteligente y me da mucho gusto conocerte. <br><br>Para poder brindarte una experiencia m√°s personalizada, ¬øme podr√≠as decir tu nombre?
                        </div>
                        <div class="message-time" id="initialTime"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Input Area -->
        <div class="input-area">
            <div class="input-container">
                <div class="input-wrapper">
                    <textarea 
                        id="messageInput" 
                        placeholder="Describe tu consulta con todo el detalle que necesites..."
                        onkeypress="handleKeyPress(event)"
                        oninput="adjustTextareaHeight()"
                    ></textarea>
                </div>
                <button class="send-btn" id="sendBtn" onclick="sendMessage()">
                    ‚û§
                </button>
            </div>
        </div>
    </div>

    <script>
        // Sistema de IA avanzado para el Asistente Inteligente
        let messageId = 0;
        let isTyping = false;
        let conversationHistory = [];
        let userProfile = {
            name: null,
            nameKnown: false,
            interests: [],
            communicationStyle: 'formal',
            previousTopics: [],
            emotionalState: 'neutral',
            expertise: [],
            goals: []
        };

        // Base de conocimiento expandida
        const knowledgeBase = {
            business: {
                strategies: ['growth hacking', 'lean startup', 'design thinking', 'agile', 'digital transformation'],
                metrics: ['KPI', 'ROI', 'CAC', 'LTV', 'churn rate', 'conversion'],
                frameworks: ['OKRs', 'SMART goals', 'SWOT', 'Porter 5 forces', 'Business Model Canvas']
            },
            technology: {
                languages: ['javascript', 'python', 'java', 'react', 'node.js', 'sql'],
                concepts: ['cloud computing', 'AI', 'machine learning', 'blockchain', 'APIs'],
                tools: ['git', 'docker', 'aws', 'kubernetes', 'tensorflow']
            },
            marketing: {
                channels: ['SEO', 'SEM', 'social media', 'email marketing', 'content marketing'],
                strategies: ['inbound', 'outbound', 'viral marketing', 'influencer marketing'],
                metrics: ['CTR', 'CPM', 'CPC', 'ROAS', 'engagement rate']
            },
            productivity: {
                methods: ['GTD', 'pomodoro', 'eisenhower matrix', 'time blocking', 'kanban'],
                tools: ['notion', 'asana', 'trello', 'slack', 'calendly'],
                concepts: ['deep work', 'flow state', 'batch processing', 'automation']
            }
        };

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('initialTime').textContent = new Date().toLocaleTimeString();
            initializeIntelligence();
        });

        function initializeIntelligence() {
            console.log('üß† Asistente Inteligente inicializado con capacidades avanzadas');
        }

        // An√°lisis avanzado de texto
        function analyzeText(text) {
            const analysis = {
                sentiment: analyzeSentiment(text),
                complexity: analyzeComplexity(text),
                topics: extractTopics(text),
                intent: detectIntent(text),
                urgency: detectUrgency(text),
                keywords: extractKeywords(text)
            };
            return analysis;
        }

        function analyzeSentiment(text) {
            const positiveWords = ['excelente', 'bueno', 'perfecto', 'genial', 'increible', 'fantastico', 'amor', 'feliz'];
            const negativeWords = ['malo', 'terrible', 'odio', 'problema', 'dificil', 'frustrado', 'imposible'];
            
            let score = 0;
            const words = text.toLowerCase().split(' ');
            
            words.forEach(word => {
                if (positiveWords.includes(word)) score += 1;
                if (negativeWords.includes(word)) score -= 1;
            });
            
            if (score > 0) return 'positive';
            if (score < 0) return 'negative';
            return 'neutral';
        }

        function analyzeComplexity(text) {
            if (text.length > 200) return 'high';
            if (text.length > 100) return 'medium';
            return 'low';
        }

        function extractTopics(text) {
            const topics = [];
            Object.keys(knowledgeBase).forEach(category => {
                Object.values(knowledgeBase[category]).flat().forEach(topic => {
                    if (text.toLowerCase().includes(topic)) {
                        topics.push({category, topic});
                    }
                });
            });
            return topics;
        }

        function detectIntent(text) {
            const intents = {
                creator_query: ['creador', 'cre√≥', 'hizo', 'empresa', 'detr√°s de ti', 'innovationx', 'az innovationx'],
                question: ['como', 'que', 'donde', 'cuando', 'por que', 'cual'],
                request: ['ayuda', 'necesito', 'quiero', 'podrias', 'me gustaria'],
                problem: ['problema', 'error', 'falla', 'no funciona', 'dificultad'],
                planning: ['plan', 'estrategia', 'organizar', 'programar', 'planificar']
            };
            
            for (let intent in intents) {
                if (intents[intent].some(word => text.toLowerCase().includes(word))) {
                    return intent;
                }
            }
            return 'general';
        }

        function detectUrgency(text) {
            const urgentWords = ['urgente', 'rapido', 'inmediato', 'ahora', 'ya', 'pronto'];
            return urgentWords.some(word => text.toLowerCase().includes(word)) ? 'high' : 'normal';
        }

        function extractKeywords(text) {
            const words = text.toLowerCase().split(' ');
            const stopWords = ['el', 'la', 'de', 'que', 'y', 'a', 'en', 'un', 'es', 'se', 'no', 'te', 'lo', 'le', 'da', 'su', 'por', 'son', 'con', 'para', 'mi', 'tu', 'si'];
            return words.filter(word => word.length > 3 && !stopWords.includes(word)).slice(0, 5);
        }

        // Generador de respuestas inteligentes
        function generateAdvancedResponse(userMessage, analysis) {
            // Actualizar perfil del usuario
            updateUserProfile(analysis);
            
            // Generar respuesta contextual
            let response = '';
            let thinkingProcess = '';
            
            // Mostrar proceso de pensamiento
            thinkingProcess = 'üß† Analizando: Sentimiento ' + analysis.sentiment + ', Complejidad ' + analysis.complexity + ', Intenci√≥n ' + analysis.intent;
            
            // Respuesta basada en an√°lisis
            if (analysis.intent === 'creator_query') {
                response = generateCreatorResponse();
            } else if (analysis.intent === 'problem') {
                response = generateProblemSolvingResponse(userMessage, analysis);
            } else if (analysis.topics.length > 0) {
                response = generateTopicBasedResponse(userMessage, analysis);
            } else if (analysis.complexity === 'high') {
                response = generateComplexResponse(userMessage, analysis);
            } else {
                // If intent is general and no specific topics were found, the bot likely doesn't know.
                if (analysis.intent === 'general' && analysis.topics.length === 0) {
                    response = generateIDontKnowResponse();
                } else {
                    response = generateContextualResponse(userMessage, analysis);
                }
            }
            
            // Personalizar respuesta seg√∫n perfil
            response = personalizeResponse(response, analysis.sentiment);
            
            // Agregar sugerencias inteligentes
            response += generateIntelligentSuggestions(analysis);
            
            return {response, thinkingProcess};
        }

        function generateProblemSolvingResponse(message, analysis) {
            const name = userProfile.name ? `, ${userProfile.name}` : '';
            const problemSolvingFramework = `Entiendo que tienes un desaf√≠o que resolver${name}. Aplicar√© mi metodolog√≠a avanzada de resoluci√≥n de problemas:<br><br>` +
                'üîç <strong>An√°lisis del problema:</strong> He detectado que tu consulta tiene un nivel de urgencia ' + analysis.urgency + ' y complejidad ' + analysis.complexity + '.<br><br>' +
                'üß† <strong>Enfoque estructurado:</strong><br>' +
                '1Ô∏è‚É£ <strong>Definici√≥n clara</strong> del problema central<br>' +
                '2Ô∏è‚É£ <strong>An√°lisis de causas ra√≠z</strong> usando t√©cnicas avanzadas<br>' +
                '3Ô∏è‚É£ <strong>Generaci√≥n de soluciones</strong> m√∫ltiples y creativas<br>' +
                '4Ô∏è‚É£ <strong>Evaluaci√≥n de viabilidad</strong> y impacto<br>' +
                '5Ô∏è‚É£ <strong>Plan de implementaci√≥n</strong> paso a paso<br><br>' +
                'Para ofrecerte la soluci√≥n m√°s efectiva, necesito entender mejor algunos aspectos espec√≠ficos:';
            return problemSolvingFramework;
        }

        function generateTopicBasedResponse(message, analysis) {
            const mainTopic = analysis.topics[0];
            const responses = {
                business: 'Excelente, estamos hablando de ' + mainTopic.topic + ' en el contexto empresarial. Mi an√°lisis indica que tienes un enfoque ' + analysis.sentiment + ' hacia este tema. Puedo ayudarte con estrategias avanzadas, an√°lisis de mercado, y implementaci√≥n de mejores pr√°cticas.',
                technology: 'Perfecto, detect√© que necesitas ayuda con ' + mainTopic.topic + '. Como especialista en tecnolog√≠a, puedo guiarte desde conceptos fundamentales hasta implementaciones avanzadas, considerando las mejores pr√°cticas actuales.',
                marketing: 'Genial, vamos a trabajar en ' + mainTopic.topic + '. Mi enfoque combina estrategias probadas con innovaciones recientes en marketing digital. Analizar√© tu situaci√≥n espec√≠fica para crear un plan personalizado.',
                productivity: 'Entiendo que quieres optimizar tu ' + mainTopic.topic + '. Bas√°ndome en metodolog√≠as avanzadas y tu perfil de trabajo, puedo dise√±ar un sistema personalizado que maximice tu eficiencia.'
            };
            return responses[mainTopic.category] || responses.business;
        }

        function generateComplexResponse(message, analysis) {
            const name = userProfile.name ? `, ${userProfile.name}` : '';
            let response = `Interesante desaf√≠o el que planteas${name}.<br><br>`;
            
            response += `üîç <strong>An√°lisis R√°pido:</strong> Veo que tu consulta involucra los siguientes temas clave: <em>${analysis.keywords.join(', ')}</em>. Tiene una complejidad ${analysis.complexity} y un sentimiento general ${analysis.sentiment}.<br><br>`;
            
            response += `üó∫Ô∏è <strong>Estructura de la Soluci√≥n:</strong> Para darte la mejor respuesta, te propongo abordar esto en 3 pasos:<br>
            1. <strong>An√°lisis Detallado:</strong> Profundizar en cada uno de los componentes de tu solicitud.<br>
            2. <strong>Propuesta de Soluci√≥n:</strong> Presentarte un plan de acci√≥n o una respuesta estructurada.<br>
            3. <strong>Siguientes Pasos:</strong> Definir c√≥mo podemos continuar y refinar la soluci√≥n.<br><br>`;

            response += `Para comenzar con el primer paso, ¬øpodr√≠as darme un poco m√°s de contexto sobre alguno de los temas que mencionaste? O si lo prefieres, puedo empezar con una soluci√≥n general basada en la informaci√≥n que ya me diste.`;

            return response;
        }

        function generateContextualResponse(message, analysis) {
            const name = userProfile.name ? userProfile.name : 't√∫';
            const lastTopic = userProfile.previousTopics.length > 0 ? userProfile.previousTopics[userProfile.previousTopics.length - 1] : null;

            if (lastTopic && Math.random() < 0.5) {
                return `Interesante pregunta, ${name}. Por lo que recuerdo, hace poco hablamos sobre '${lastTopic}'. ¬øEsto que me preguntas ahora se relaciona con ese tema?`;
            }

            const contextResponses = [
                `Buena pregunta, ${name}. He notado un patr√≥n en nuestras conversaciones que me permite ofrecerte una respuesta m√°s personalizada.`,
                `Bas√°ndome en tu estilo de comunicaci√≥n y consultas anteriores, ${name}, puedo adaptar mi respuesta a tus necesidades espec√≠ficas.`,
                'Tu enfoque ' + analysis.sentiment + ' hacia este tema me ayuda a calibrar la mejor manera de asistirte.'
            ];
            return contextResponses[Math.floor(Math.random() * contextResponses.length)];
        }

        function generateCreatorResponse() {
            return `Fui creado por Az InnovationX, una empresa innovadora especializada en soluciones tecnol√≥gicas avanzadas.<br>
Si quieres conocer m√°s sobre ellos, puedes visitarlos en:<br>
üåê Sitio web: <a href="https://az-innovation-x.vercel.app/" target="_blank">https://az-innovation-x.vercel.app/</a><br>
üìò Facebook: <a href="https://www.facebook.com/AzInnovationX?mibextid=ZbWKwL" target="_blank">AzInnovationX en Facebook</a><br>
üéµ TikTok: <a href="https://www.tiktok.com/@innovationx09?_t=ZS-8z7nlnJKq2C&_r=1" target="_blank">@innovationx09 en TikTok</a><br><br>
Az InnovationX se dedica a crear experiencias digitales inteligentes y soluciones que realmente conectan con las personas. ¬°Estoy orgulloso de ser parte de sus innovaciones!`;
        }

        function generateIDontKnowResponse() {
            const name = userProfile.name ? `, ${userProfile.name}` : '';
            const responses = [
                `Esa es una pregunta muy interesante${name}. No estoy seguro de tener la respuesta correcta en mi base de conocimiento actual. ¬øPodr√≠as reformularla o darme un poco m√°s de detalle?`,
                `Hmm, eso me ha puesto a pensar. No tengo informaci√≥n espec√≠fica sobre ese tema${name}. Agradezco que me ayudes a aprender. ¬øPodemos intentar enfocarlo desde otro √°ngulo?`,
                `Admito que no lo s√© todo${name}. Sobre este tema en particular no tengo una respuesta. Sin embargo, puedo intentar buscar informaci√≥n relacionada si lo deseas.`
            ];
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function personalizeResponse(response, sentiment) {
            const name = userProfile.name ? `, ${userProfile.name}` : '';
            if (sentiment === 'positive') {
                response += `<br><br>üåü Me alegra ver tu entusiasmo sobre este tema${name}. ¬°Esa es la actitud para lograr grandes cosas!`;
            } else if (sentiment === 'negative') {
                response += `<br><br>ü§ù Entiendo que esto puede ser frustrante${name}. No te preocupes, estoy aqu√≠ para ayudarte a superarlo. Trabajemos juntos para convertir estos obst√°culos en oportunidades.`;
            } else if (sentiment === 'neutral' && Math.random() < 0.3) { // Occasionally add a personal touch
                response += `<br><br>Es un punto interesante${name}. Sigamos profundizando en ello.`;
            }
            return response;
        }

        function generateIntelligentSuggestions(analysis) {
            let suggestions = '<br><br>üí° <strong>Sugerencias inteligentes para seguir avanzando:</strong><br>';
            
            if (analysis.urgency === 'high') {
                suggestions += '‚ö° Dado que esto es urgente, ¬øte parece si priorizamos las acciones con mayor impacto inmediato?<br>';
            }
            
            if (analysis.complexity === 'high') {
                suggestions += 'üß© Para manejar mejor esta complejidad, podr√≠amos desglosar el problema en fases m√°s peque√±as. ¬øQu√© opinas?<br>';
            }
            
            suggestions += 'üìö ¬øPrefieres que profundice en alg√∫n aspecto, te d√© una explicaci√≥n m√°s t√©cnica o busque ejemplos pr√°cticos?';
            
            return suggestions;
        }

        function updateUserProfile(analysis) {
            // Actualizar intereses
            analysis.topics.forEach(topic => {
                if (!userProfile.interests.includes(topic.category)) {
                    userProfile.interests.push(topic.category);
                }
            });
            
            // Actualizar estado emocional
            userProfile.emotionalState = analysis.sentiment;
            
            // Agregar temas previos
            userProfile.previousTopics.push(...analysis.keywords);
            
            // Mantener solo los √∫ltimos 10 temas
            userProfile.previousTopics = userProfile.previousTopics.slice(-10);
        }

        function setQuickMessage(message) {
            document.getElementById('messageInput').value = message;
            document.getElementById('messageInput').focus();
        }

        function adjustTextareaHeight() {
            const textarea = document.getElementById('messageInput');
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 150) + 'px';
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message || isTyping) return;

            // Agregar mensaje del usuario
            addMessage(message, 'user');
            conversationHistory.push({type: 'user', content: message, timestamp: new Date()});
            
            // Limpiar input
            input.value = '';
            input.style.height = 'auto';
            
            // Mostrar indicador de escritura
            showTypingIndicator();

            // --- INICIO: L√≥gica de captura de nombre ---
            if (!userProfile.nameKnown) {
                userProfile.name = message;
                userProfile.nameKnown = true;

                setTimeout(() => {
                    hideTypingIndicator();
                    const welcomeMessage = `¬°Perfecto, ${userProfile.name}! Es un placer conocerte. Estoy aqu√≠ para ayudarte con cualquier pregunta, proyecto o desaf√≠o que tengas. <br><br>¬øEn qu√© puedo asistirte hoy?`;
                    addMessage(welcomeMessage, 'bot');
                    conversationHistory.push({type: 'bot', content: welcomeMessage, timestamp: new Date()});
                }, 1500);

                return; // Detener la ejecuci√≥n normal
            }
            // --- FIN: L√≥gica de captura de nombre ---
            
            // Analizar mensaje y generar respuesta
            setTimeout(() => {
                const analysis = analyzeText(message);
                const aiResponse = generateAdvancedResponse(message, analysis);
                
                hideTypingIndicator();
                
                // Mostrar proceso de pensamiento
                if (analysis.complexity === 'high' || analysis.intent === 'problem') {
                    showThinkingProcess(aiResponse.thinkingProcess);
                    setTimeout(() => {
                        addMessage(aiResponse.response, 'bot');
                        conversationHistory.push({type: 'bot', content: aiResponse.response, timestamp: new Date(), analysis: analysis});
                    }, 1000);
                } else {
                    addMessage(aiResponse.response, 'bot');
                    conversationHistory.push({type: 'bot', content: aiResponse.response, timestamp: new Date(), analysis: analysis});
                }
            }, 2000);
        }

        function addMessage(content, type) {
            const container = document.getElementById('messagesContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ' + type;
            
            const time = new Date().toLocaleTimeString();
            const avatar = type === 'bot' ? 'üß†' : 'üë§';
            
            messageDiv.innerHTML = 
                '<div class="message-content">' +
                    '<div class="message-avatar ' + type + '">' + avatar + '</div>' +
                    '<div class="message-bubble ' + type + '">' +
                        '<div>' + content + '</div>' +
                        '<div class="message-time">' + time + '</div>' +
                    '</div>' +
                '</div>';
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function showThinkingProcess(process) {
            const container = document.getElementById('messagesContainer');
            const thinkingDiv = document.createElement('div');
            thinkingDiv.className = 'message bot';
            thinkingDiv.id = 'thinkingProcess';
            
            thinkingDiv.innerHTML = 
                '<div class="message-content">' +
                    '<div class="message-avatar bot">üß†</div>' +
                    '<div class="thinking-process">' +
                        process +
                    '</div>' +
                '</div>';
            
            container.appendChild(thinkingDiv);
            container.scrollTop = container.scrollHeight;
            
            // Remover despu√©s de mostrar la respuesta
            setTimeout(() => {
                const thinking = document.getElementById('thinkingProcess');
                if (thinking) {
                    thinking.remove();
                }
            }, 3000);
        }

        function showTypingIndicator() {
            if (isTyping) return;
            
            isTyping = true;
            const container = document.getElementById('messagesContainer');
            const sendBtn = document.getElementById('sendBtn');
            
            sendBtn.disabled = true;
            
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typingIndicator';
            
            typingDiv.innerHTML = 
                '<div class="typing-content">' +
                    '<div class="message-avatar bot">üß†</div>' +
                    '<div class="typing-bubble">' +
                        '<div class="typing-dots">' +
                            '<div class="typing-dot"></div>' +
                            '<div class="typing-dot"></div>' +
                            '<div class="typing-dot"></div>' +
                        '</div>' +
                    '</div>' +
                '</div>';
            
            container.appendChild(typingDiv);
            container.scrollTop = container.scrollHeight;
        }

        function hideTypingIndicator() {
            isTyping = false;
            const typingIndicator = document.getElementById('typingIndicator');
            const sendBtn = document.getElementById('sendBtn');
            
            if (typingIndicator) {
                typingIndicator.remove();
            }
            
            sendBtn.disabled = false;
        }

        // Funciones adicionales para inteligencia avanzada
        function getContextualInfo() {
            const recentMessages = conversationHistory.slice(-5);
            const recentTopics = recentMessages.flatMap(msg => 
                msg.analysis ? msg.analysis.keywords : []
            );
            
            return {
                recentTopics: [...new Set(recentTopics)],
                conversationLength: conversationHistory.length,
                userMood: userProfile.emotionalState,
                mainInterests: userProfile.interests
            };
        }

        function adaptResponseStyle(analysis, context) {
            let style = {
                formality: 'professional',
                detail: 'medium',
                examples: true,
                followUp: true
            };
            
            // Adaptar seg√∫n sentimiento
            if (analysis.sentiment === 'negative') {
                style.formality = 'empathetic';
                style.detail = 'high';
            }
            
            // Adaptar seg√∫n complejidad
            if (analysis.complexity === 'high') {
                style.detail = 'high';
                style.examples = true;
            }
            
            // Adaptar seg√∫n historial
            if (context.conversationLength > 5) {
                style.formality = 'friendly';
                style.followUp = false;
            }
            
            return style;
        }

        // Simulaci√≥n de aprendizaje continuo
        function learnFromInteraction(userMessage, botResponse, analysis) {
            // Actualizar base de conocimientos basado en interacciones
            if (analysis.topics.length > 0) {
                analysis.topics.forEach(topic => {
                    if (!userProfile.expertise.includes(topic.topic)) {
                        userProfile.expertise.push(topic.topic);
                    }
                });
            }
            
            // Detectar patrones de comunicaci√≥n
            if (userMessage.length > 100) {
                userProfile.communicationStyle = 'detailed';
            } else if (userMessage.length < 30) {
                userProfile.communicationStyle = 'concise';
            }
            
            console.log('üìö Asistente Inteligente aprendiendo de la interacci√≥n...', {
                userStyle: userProfile.communicationStyle,
                interests: userProfile.interests,
                expertise: userProfile.expertise.slice(-3)
            });
        }

        // Sistema de memoria mejorado
        function rememberContext(message, analysis) {
            const contextItem = {
                message: message,
                analysis: analysis,
                timestamp: new Date(),
                importance: calculateImportance(analysis)
            };
            
            // Mantener solo contextos importantes
            if (contextItem.importance > 0.5) {
                conversationHistory.push(contextItem);
                // Mantener solo los √∫ltimos 20 contextos
                if (conversationHistory.length > 20) {
                    conversationHistory = conversationHistory.slice(-20);
                }
            }
        }

        function calculateImportance(analysis) {
            let importance = 0;
            
            if (analysis.intent === 'problem') importance += 0.3;
            if (analysis.complexity === 'high') importance += 0.2;
            if (analysis.urgency === 'high') importance += 0.3;
            if (analysis.topics.length > 0) importance += 0.2;
            
            return importance;
        }

        // Personalizaci√≥n avanzada
        function getPersonalizedGreeting() {
            const greetings = [
                '¬°Hola de nuevo! Noto que has vuelto con m√°s consultas interesantes.',
                'Me alegra verte nuevamente. ¬øEn qu√© nuevo desaf√≠o puedo ayudarte?',
                'Bienvenido otra vez. He estado procesando nuestras conversaciones anteriores.'
            ];
            
            if (conversationHistory.length > 3) {
                return greetings[Math.floor(Math.random() * greetings.length)];
            }
            
            return '¬°Hola! Soy tu Asistente Inteligente, listo para ayudarte con cualquier desaf√≠o.';
        }

        // Inicializar sistema inteligente
        console.log('üöÄ Asistente Inteligente - Sistema Avanzado Cargado');
        console.log('üí° Capacidades: An√°lisis NLP, Memoria Contextual, Aprendizaje Adaptativo');
    </script>
</body>
</html>
